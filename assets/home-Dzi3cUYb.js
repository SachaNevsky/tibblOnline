import{w as O,a as d,p as a}from"./chunk-EPOLDU6W-Wp3N_t67.js";function I({}){return[{title:"TIBBL Online"},{name:"description",content:"TIBBL tangible programming online"}]}const m="https://raw.githubusercontent.com/armbennett/tangible-11ty/main",B=[["play","playx","loop","endloop"],["thread1","thread2","thread3","delay"],["variable","random","add","subtract"],["if","else","endif"],["function","endfunction","functioncall"]],G={add:"x = x + 1",subtract:"x = x - 1",delay:"delay 1",else:"else",endfunction:"end function",endif:"end if",endloop:"end loop",function:"function",functioncall:"call function",if:"if x < 5",loop:"loop 3 times",play:"play 1",playx:"play x",random:"x = random",thread1:"thread 1",thread2:"thread 2",thread3:"thread 3",variable:"x = 1"},H=O(function(){const[c,f]=d.useState(Array(6).fill(null).map(()=>Array(5).fill(null))),[u,x]=d.useState(null),[o,y]=d.useState(null),[j,v]=d.useState(!0),[w,h]=d.useState(!1),[b,g]=d.useState(["","",""]);d.useEffect(()=>{(async()=>{try{const s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js",document.head.appendChild(s),await new Promise(i=>{s.onload=()=>i()});const l=(await(await fetch(`${m}/assets/js/tangible.js`)).text()).replace("export default class Tangible","window.Tangible = class Tangible"),r=document.createElement("script");r.textContent=l,document.head.appendChild(r),v(!1)}catch(s){console.error("Error loading scripts:",s)}})()},[]);const T=(t,s)=>{x(s),t.dataTransfer.effectAllowed="copy"},N=t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy"},C=(t,s,e)=>{if(t.preventDefault(),u){const n=c.map(l=>[...l]);n[s][e]=u,f(n),x(null)}},S=(t,s)=>{const e=c.map(n=>[...n]);e[t][s]=null,f(e)},D=()=>{const t=[[],[],[]];let s=0;for(let e=0;e<c.length;e++)for(let n=0;n<c[e].length;n++){const l=c[e][n];if(l){const r=G[l];l==="thread1"?s=0:l==="thread2"?s=1:l==="thread3"&&(s=2),t[s].push(r)}}return t},p=(t,s,e)=>{const n=new window.Howl({src:[`${m}/assets/sound/${s}.mp3`],volume:.2,sprite:t.soundSets[s]});t.threads[e]=n},$=()=>{if(window.Tangible)try{const t=D();if(!t.some(e=>e.length>0)){g(["","",""]);return}if(h(!0),g(t.map(e=>e.join(`
`))),o){const e=t.flat().join(`
`),n=o.parseTextAsJavascript(e);o.evalTile(n,o);let l=0;for(let r=0;r<o.codeThreads.length;r++)o.codeThreads[r].length>0&&(o.playStart(o.threads[r],o.codeThreads[r]),l=Math.max(l,o.codeThreads[r].length));setTimeout(()=>{h(!1)},l*1e3)}else{const e=new window.Tangible;p(e,"LowAndFX",0),p(e,"High",1),p(e,"Drums",2),y(e),setTimeout(()=>{const n=t.flat().join(`
`),l=e.parseTextAsJavascript(n);e.evalTile(l,e);let r=0;for(let i=0;i<e.codeThreads.length;i++)e.codeThreads[i].length>0&&(e.playStart(e.threads[i],e.codeThreads[i]),r=Math.max(r,e.codeThreads[i].length));setTimeout(()=>{h(!1)},r*1e3)},500)}}catch(t){g([`Error: ${t.message}`,"",""]),h(!1),console.error(t)}},E=()=>{if(o){for(let t=0;t<o.threads.length;t++){const s=o.threads[t];s&&s.stop()}o.codeThreads=[[],[],[]],h(!1)}},A=()=>{f(Array(6).fill(null).map(()=>Array(5).fill(null))),g(["","",""]),h(!1)};if(j)return a.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:a.jsx("div",{className:"text-xl",children:"Loading TIBBL system..."})});const L=b.some(t=>t.length>0);return a.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-8 flex items-center justify-center",children:a.jsxs("div",{className:"w-full h-[90vh] flex flex-col",children:[a.jsxs("h1",{className:"inline-flex items-center gap-2 text-4xl font-bold mb-6 shrink-0",children:[a.jsx("img",{src:"tibbl-logo.png",alt:"Tibbl logo",className:"h-[1em] w-auto"}),"Online"]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 flex-1 min-h-0",children:[a.jsx("div",{className:"lg:col-span-1 flex flex-col min-h-0",children:a.jsx("div",{className:"bg-gray-800 p-4 rounded-lg space-y-3 overflow-auto h-full",children:B.map((t,s)=>a.jsx("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map(e=>a.jsxs("div",{draggable:!0,onDragStart:n=>T(n,e),className:"cursor-grab active:cursor-grabbing bg-gray-700 rounded p-2 hover:bg-gray-600 transition",children:[a.jsx("img",{src:`${m}/assets/demo-files/tiles/${e}.png`,alt:e,className:"w-full h-auto mb-1"}),a.jsx("div",{className:"text-xs sm:text-xs text-center text-gray-300",children:e})]},e))},s))})}),a.jsx("div",{className:"lg:col-span-2 flex flex-col min-h-0",children:a.jsx("div",{className:"bg-gray-800 p-4 rounded-lg h-full flex items-center justify-center",children:a.jsx("div",{className:"grid grid-cols-5 gap-2 h-full w-auto",style:{aspectRatio:"5/6"},children:c.map((t,s)=>t.map((e,n)=>a.jsx("div",{onDragOver:N,onDrop:l=>C(l,s,n),onClick:()=>e&&S(s,n),className:`border-2 border-dashed rounded flex items-center justify-center aspect-square ${e?"border-green-500 bg-gray-700 cursor-pointer hover:bg-gray-600":"border-gray-600 bg-gray-750"}`,children:e&&a.jsx("img",{src:`${m}/assets/demo-files/tiles/${e}.png`,alt:e,className:"w-full h-full object-contain p-1"})},`${s}-${n}`)))})})}),a.jsxs("div",{className:"lg:col-span-1 flex flex-col min-h-0",children:[a.jsxs("div",{className:"flex flex-col gap-2 mb-4 shrink-0",children:[a.jsx("button",{onClick:$,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 rounded transition font-semibold",children:"Run Code"}),a.jsx("button",{onClick:E,className:"w-full px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded transition font-semibold",children:"Stop"}),a.jsx("button",{onClick:A,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 rounded transition",children:"Clear Grid"})]}),L?a.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex-1 overflow-auto min-h-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"Code:"}),w&&a.jsx("span",{className:"text-sm text-green-400 font-semibold",children:"Running..."})]}),a.jsx("div",{className:"grid grid-cols-3 gap-4",children:b.map((t,s)=>a.jsx("div",{children:t&&a.jsx("pre",{className:"text-xs text-gray-300 whitespace-pre-wrap font-mono",children:t})},s))})]}):a.jsx("div",{className:"bg-gray-800 p-4 rounded-lg flex-1 overflow-auto min-h-0"})]})]})]})})});export{H as default,I as meta};
