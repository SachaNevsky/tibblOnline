import{w as W,a as m,p as a}from"./chunk-EPOLDU6W-Wp3N_t67.js";function K({}){return[{title:"TIBBL Online"},{name:"description",content:"TIBBL tangible programming online"}]}function Q(){return[{rel:"icon",href:"/tibblOnline/favicon.ico",type:"image/ico"}]}const f="https://raw.githubusercontent.com/armbennett/tangible-11ty/main",F=[["play","playx","loop","endloop"],["thread1","thread2","thread3","delay"],["variable","random","add","subtract"],["if","else","endif"],["function","endfunction","functioncall"]],u={add:{name:"X = X + 1",command:"x = x + 1",rotatable:!1},subtract:{name:"X = X - 1",command:"x = x - 1",rotatable:!1},delay:{name:"Delay",command:"delay",rotatable:!0,rotationValues:["1","2","3","4","5","6","7","8"]},else:{name:"Else",command:"else",rotatable:!1},endfunction:{name:"End Function",command:"end function",rotatable:!1},endif:{name:"End If",command:"end if",rotatable:!1},endloop:{name:"End Loop",command:"end loop",rotatable:!1},function:{name:"Function",command:"function",rotatable:!1},functioncall:{name:"Call Function",command:"call function",rotatable:!1},if:{name:"If X <",command:"if x <",rotatable:!0,rotationValues:["1","2","3","4","5","6","7","8"]},loop:{name:"Loop",command:"loop",rotatable:!0,rotationValues:["1","2","3","4","5","6","7","8"]},play:{name:"Play",command:"play",rotatable:!0,rotationValues:["1","2","3","4","5","6","7","8"]},playx:{name:"Play X",command:"play x",rotatable:!1},random:{name:"X=Random",command:"x = random",rotatable:!1},thread1:{name:"Thread 1",command:"thread 1",rotatable:!1},thread2:{name:"Thread 2",command:"thread 2",rotatable:!1},thread3:{name:"Thread 3",command:"thread 3",rotatable:!1},variable:{name:"X =",command:"x =",rotatable:!0,rotationValues:["1","2","3","4","5","6","7","8"]}},T=[{value:"MusicLoops1",label:"Music Loops 1"},{value:"Mystery",label:"Mystery"},{value:"Numbers",label:"Numbers"},{value:"Notifications",label:"Notifications"},{value:"OdeToJoy",label:"Ode to Joy"},{value:"FurElise",label:"FÃ¼r Elise"}],Z=W(function(){const[c,p]=m.useState(Array(7).fill(null).map(()=>Array(5).fill(null))),[r,x]=m.useState(null),[i,B]=m.useState(null),[J,H]=m.useState(!0),[S,h]=m.useState(!1),[j,b]=m.useState(["","",""]),[g,_]=m.useState(["Numbers","Mystery","Notifications"]),[C,$]=m.useState(null);m.useEffect(()=>{(async()=>{try{const s=document.createElement("script");s.src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js",document.head.appendChild(s),await new Promise(d=>{s.onload=()=>d()});const n=(await(await fetch(`${f}/assets/js/tangible.js`)).text()).replace("export default class Tangible","window.Tangible = class Tangible"),o=document.createElement("script");o.textContent=n,document.head.appendChild(o),H(!1)}catch(s){console.error("Error loading scripts:",s)}})()},[]);const y=(t,s,e=!1,l)=>{x({type:s,fromGrid:e,gridPos:l}),t.dataTransfer.effectAllowed="copy"},D=t=>{t.preventDefault(),t.dataTransfer.dropEffect="copy"},P=(t,s,e)=>{if(t.preventDefault(),t.stopPropagation(),r){const l=c.map(n=>[...n]);if(r.fromGrid&&r.gridPos){const n=c[r.gridPos.row][r.gridPos.col];l[r.gridPos.row][r.gridPos.col]=null,l[s][e]=n}else l[s][e]={type:r.type,rotation:0};p(l),x(null)}},E=t=>{if(t.preventDefault(),t.stopPropagation(),r&&r.fromGrid&&r.gridPos){const s=c.map(e=>[...e]);s[r.gridPos.row][r.gridPos.col]=null,p(s),x(null)}},O=(t,s,e=!1,l)=>{const n=t.touches[0];$({x:n.clientX,y:n.clientY}),x({type:s,fromGrid:e,gridPos:l}),t.preventDefault()},G=t=>{!r||!C||t.preventDefault()},k=t=>{if(!r||!C)return;const s=t.changedTouches[0],e=document.elementFromPoint(s.clientX,s.clientY);if(e){const l=e.closest("[data-grid-cell]");if(l){const n=parseInt(l.getAttribute("data-row")||"0"),o=parseInt(l.getAttribute("data-col")||"0"),d=c.map(w=>[...w]);if(r.fromGrid&&r.gridPos){const w=c[r.gridPos.row][r.gridPos.col];d[r.gridPos.row][r.gridPos.col]=null,d[n][o]=w}else d[n][o]={type:r.type,rotation:0};p(d)}else if(e.closest("[data-palette]")&&r.fromGrid&&r.gridPos){const n=c.map(o=>[...o]);n[r.gridPos.row][r.gridPos.col]=null,p(n)}}x(null),$(null)},L=(t,s)=>{const e=c[t][s];if(e&&u[e.type].rotatable){const l=c.map(o=>[...o]),n=u[e.type].rotationValues?.length||8;l[t][s]={...e,rotation:(e.rotation+1)%n},p(l)}},R=t=>{const s=u[t.type];if(!s.rotatable)return s.name;const e=s.rotationValues?.[t.rotation]||"1";switch(t.type){case"play":return`Play ${e}`;case"loop":return`Loop ${e} Times`;case"delay":return`Delay ${e}`;case"variable":return`X = ${e}`;case"if":return`If X < ${e}`;default:return s.name}},q=t=>{const s=u[t.type];if(!s.rotatable)return s.command;const e=s.rotationValues?.[t.rotation]||"1";switch(t.type){case"play":return`play ${e}`;case"loop":return`loop ${e} times`;case"delay":return`delay ${e}`;case"variable":return`x = ${e}`;case"if":return`if x < ${e}`;default:return s.command}},U=()=>{const t=[[],[],[]];let s=0;for(let e=0;e<c.length;e++)for(let l=0;l<c[e].length;l++){const n=c[e][l];if(n){const o=q(n);n.type==="thread1"?s=0:n.type==="thread2"?s=1:n.type==="thread3"&&(s=2),t[s].push(o)}}return t},v=(t,s,e)=>{const l=new window.Howl({src:[`${f}/assets/sound/${s}.mp3`],volume:.2,sprite:t.soundSets[s]});t.threads[e]=l},N=(t,s)=>{const e=[...g];e[t]=s,_(e),i&&v(i,s,t)},X=()=>{if(window.Tangible)try{const t=U();if(!t.some(e=>e.length>0)){b(["","",""]);return}if(h(!0),b(t.map(e=>e.join(`
`))),i){const e=t.flat().join(`
`),l=i.parseTextAsJavascript(e);i.evalTile(l,i);let n=0;for(let o=0;o<i.codeThreads.length;o++)i.codeThreads[o].length>0&&(i.playStart(i.threads[o],i.codeThreads[o]),n=Math.max(n,i.codeThreads[o].length));setTimeout(()=>{h(!1)},n*1e3)}else{const e=new window.Tangible;v(e,g[0],0),v(e,g[1],1),v(e,g[2],2),B(e),setTimeout(()=>{const l=t.flat().join(`
`),n=e.parseTextAsJavascript(l);e.evalTile(n,e);let o=0;for(let d=0;d<e.codeThreads.length;d++)e.codeThreads[d].length>0&&(e.playStart(e.threads[d],e.codeThreads[d]),o=Math.max(o,e.codeThreads[d].length));setTimeout(()=>{h(!1)},o*1e3)},500)}}catch(t){b([`Error: ${t.message}`,"",""]),h(!1),console.error(t)}},A=()=>{if(i){for(let t=0;t<i.threads.length;t++){const s=i.threads[t];s&&s.stop()}i.codeThreads=[[],[],[]],h(!1)}},M=()=>{p(Array(7).fill(null).map(()=>Array(5).fill(null))),b(["","",""]),h(!1)};if(J)return a.jsx("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:a.jsx("div",{className:"text-xl",children:"Loading TIBBL system..."})});const V=j.some(t=>t.length>0);return a.jsx("div",{className:"h-screen bg-gray-900 text-white flex items-center justify-center overflow-hidden",children:a.jsxs("div",{className:"w-full h-full flex flex-col p-2 sm:p-4 lg:p-8",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 items-center mb-2 sm:mb-4 lg:mb-6 shrink-0 gap-2 sm:gap-4 lg:gap-8",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("h1",{className:"inline-flex items-center gap-2 text-2xl sm:text-3xl lg:text-4xl font-bold",children:[a.jsx("img",{src:"tibbl-logo.png",alt:"Tibbl logo",className:"h-[1em] w-auto"}),"Online"]}),a.jsx("a",{href:"/tibblOnline/reverse",className:"pl-4 inline-flex items-center gap-2 text-2xl sm:text-3xl lg:text-4xl font-bold text-blue-500",children:"Go to reverse"})]}),a.jsxs("div",{className:"lg:col-start-4 flex items-center gap-2 sm:gap-4 w-full",children:[a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsx("label",{className:"text-white font-bold mb-1 text-xs sm:text-sm",children:"Thread 1:"}),a.jsx("select",{value:g[0],onChange:t=>N(0,t.target.value),className:"bg-gray-800 text-white px-2 py-1 text-xs sm:text-sm rounded border border-gray-700 focus:outline-none focus:border-blue-500",children:T.map(t=>a.jsx("option",{value:t.value,children:t.label},t.value))})]}),a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsx("label",{className:"text-white font-bold mb-1 text-xs sm:text-sm",children:"Thread 2:"}),a.jsx("select",{value:g[1],onChange:t=>N(1,t.target.value),className:"bg-gray-800 text-white px-2 py-1 text-xs sm:text-sm rounded border border-gray-700 focus:outline-none focus:border-blue-500",children:T.map(t=>a.jsx("option",{value:t.value,children:t.label},t.value))})]}),a.jsxs("div",{className:"flex flex-col w-full",children:[a.jsx("label",{className:"text-white font-bold mb-1 text-xs sm:text-sm",children:"Thread 3:"}),a.jsx("select",{value:g[2],onChange:t=>N(2,t.target.value),className:"bg-gray-800 text-white px-2 py-1 text-xs sm:text-sm rounded border border-gray-700 focus:outline-none focus:border-blue-500",children:T.map(t=>a.jsx("option",{value:t.value,children:t.label},t.value))})]})]})]}),a.jsxs("div",{className:"hidden lg:grid lg:grid-cols-4 gap-8 flex-1 min-h-0",children:[a.jsx("div",{className:"lg:col-span-1 flex flex-col min-h-0",children:a.jsx("div",{className:"bg-gray-800 p-4 rounded-lg space-y-3 overflow-auto h-full",onDrop:E,onDragOver:t=>t.preventDefault(),children:F.map((t,s)=>a.jsx("div",{className:"grid gap-3",style:{gridTemplateColumns:`repeat(${t.length}, minmax(0, 1fr))`},children:t.map(e=>a.jsxs("div",{draggable:!0,onDragStart:l=>y(l,e),className:"cursor-grab active:cursor-grabbing bg-gray-700 rounded p-2 hover:bg-gray-600 transition select-none",children:[a.jsx("img",{src:`${f}/assets/demo-files/tiles/${e}.png`,alt:e,className:"w-full h-auto mb-1 pointer-events-none"}),a.jsx("div",{className:"text-xs sm:text-xs text-center text-gray-300",children:u[e].name})]},e))},s))})}),a.jsx("div",{className:"lg:col-span-2 flex flex-col min-h-0",children:a.jsx("div",{className:"bg-gray-800 p-4 rounded-lg h-full flex items-center justify-center",children:a.jsx("div",{className:"grid grid-cols-5 gap-2 h-full w-auto",style:{aspectRatio:"5/7"},children:c.map((t,s)=>t.map((e,l)=>a.jsx("div",{onDragOver:D,onDrop:n=>P(n,s,l),onClick:()=>e&&L(s,l),className:`border-2 border-dashed rounded flex flex-col items-center justify-center aspect-square ${e?`border-green-500 bg-gray-700 ${u[e.type].rotatable?"cursor-pointer hover:bg-gray-600":"cursor-move"}`:"border-gray-600 bg-gray-750"}`,children:e&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-full h-full flex items-center justify-center p-1 select-none flex-col",draggable:!0,onDragStart:n=>{n.stopPropagation(),y(n,e.type,!0,{row:s,col:l})},children:[a.jsx("img",{src:`${f}/assets/demo-files/tiles/${e.type}.png`,alt:e.type,className:"w-full h-full object-contain pointer-events-none"}),a.jsx("div",{className:"text-xs sm:text-xs text-center text-gray-300",children:R(e)})]})})},`${s}-${l}`)))})})}),a.jsxs("div",{className:"lg:col-span-1 flex flex-col min-h-0",children:[a.jsxs("div",{className:"flex flex-col gap-2 mb-4 shrink-0",children:[a.jsx("button",{onClick:X,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 rounded transition font-semibold",children:"Run Code"}),a.jsx("button",{onClick:A,className:"w-full px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded transition font-semibold",children:"Stop"}),a.jsx("button",{onClick:M,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 rounded transition",children:"Clear Grid"})]}),V?a.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg flex-1 overflow-auto min-h-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"Code:"}),S&&a.jsx("span",{className:"text-sm text-green-400 font-semibold",children:"Running..."})]}),j.map((t,s)=>a.jsx("div",{className:"pb-4",children:t&&a.jsx("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap font-mono",children:t})},s))]}):a.jsx("div",{className:"bg-gray-800 p-4 rounded-lg flex-1 overflow-auto min-h-0"})]})]}),a.jsxs("div",{className:"lg:hidden flex flex-col flex-1 min-h-0 gap-2 sm:gap-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-4 flex-1 min-h-0",children:[a.jsx("div",{className:"flex flex-col min-h-0",children:a.jsx("div",{"data-palette":"true",className:"bg-gray-800 p-2 sm:p-3 rounded-lg space-y-1.5 sm:space-y-2 overflow-auto h-full",onDrop:E,onDragOver:t=>t.preventDefault(),children:F.map((t,s)=>a.jsx("div",{className:"grid gap-1.5 sm:gap-2",style:{gridTemplateColumns:"repeat(4, minmax(0, 1fr))"},children:t.map(e=>a.jsxs("div",{draggable:!0,onDragStart:l=>y(l,e),onTouchStart:l=>O(l,e),onTouchMove:G,onTouchEnd:k,className:"cursor-grab active:cursor-grabbing bg-gray-700 rounded p-1 hover:bg-gray-600 transition select-none touch-none",children:[a.jsx("img",{src:`${f}/assets/demo-files/tiles/${e}.png`,alt:e,className:"w-full h-auto mb-0.5 pointer-events-none"}),a.jsx("div",{className:"text-[0.5rem] sm:text-xs text-center text-gray-300 leading-tight",children:u[e].name})]},e))},s))})}),a.jsx("div",{className:"flex flex-col min-h-0",children:a.jsx("div",{className:"bg-gray-800 p-2 sm:p-3 rounded-lg h-full flex items-center justify-center",children:a.jsx("div",{className:"grid grid-cols-5 gap-1 sm:gap-1.5 h-auto w-full",style:{aspectRatio:"5/7"},children:c.map((t,s)=>t.map((e,l)=>a.jsx("div",{"data-grid-cell":"true","data-row":s,"data-col":l,onDragOver:D,onDrop:n=>P(n,s,l),onClick:()=>e&&L(s,l),className:`border border-dashed rounded flex flex-col items-center justify-center aspect-square ${e?`border-green-500 bg-gray-700 ${u[e.type].rotatable?"cursor-pointer hover:bg-gray-600":"cursor-move"}`:"border-gray-600 bg-gray-750"}`,children:e&&a.jsx(a.Fragment,{children:a.jsxs("div",{className:"w-full h-full flex items-center justify-center p-0.5 select-none flex-col",draggable:!0,onDragStart:n=>{n.stopPropagation(),y(n,e.type,!0,{row:s,col:l})},onTouchStart:n=>O(n,e.type,!0,{row:s,col:l}),onTouchMove:G,onTouchEnd:k,children:[a.jsx("img",{src:`${f}/assets/demo-files/tiles/${e.type}.png`,alt:e.type,className:"w-full h-full object-contain pointer-events-none"}),a.jsx("div",{className:"text-[0.5rem] sm:text-xs text-center text-gray-300 leading-tight",children:R(e)})]})})},`${s}-${l}`)))})})})]}),a.jsxs("div",{className:"flex flex-col min-h-0 shrink-0",style:{height:"35%"},children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2 shrink-0",children:[a.jsx("button",{onClick:X,className:"px-2 py-1.5 sm:py-2 bg-green-600 hover:bg-green-700 rounded transition font-semibold text-xs sm:text-sm",children:"Run Code"}),a.jsx("button",{onClick:A,className:"px-2 py-1.5 sm:py-2 bg-yellow-600 hover:bg-yellow-700 rounded transition font-semibold text-xs sm:text-sm",children:"Stop"}),a.jsx("button",{onClick:M,className:"px-2 py-1.5 sm:py-2 bg-red-600 hover:bg-red-700 rounded transition text-xs sm:text-sm",children:"Clear Grid"})]}),V?a.jsxs("div",{className:"bg-gray-800 p-2 sm:p-3 rounded-lg flex-1 overflow-auto min-h-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"text-sm sm:text-base font-semibold",children:"Code:"}),S&&a.jsx("span",{className:"text-xs sm:text-sm text-green-400 font-semibold",children:"Running..."})]}),j.map((t,s)=>a.jsx("div",{className:"sm:pb-3",children:t&&a.jsx("pre",{className:"text-xs sm:text-sm text-gray-300 font-mono whitespace-pre-wrap wrap-break-word sm:columns-5 gap-6",children:t})},s))]}):a.jsx("div",{className:"bg-gray-800 p-2 sm:p-3 rounded-lg flex-1 overflow-auto min-h-0"})]})]})]})})});export{Z as default,Q as links,K as meta};
